<head>
  <title>Wedding Fibbage</title>
</head>

<body>
	{{#if currentUser}}{{else}} 
		{{> loginButtons}}
	{{/if}}
	{{> UI.dynamic template=message}}
	{{> UI.dynamic template=state}}
</body>
<template name="loginPrompt">
	<h1>Welcome to Wedding Fibbage</h1>
	<p>Please Login/Create an account to continue</p>
</template>
<template name="message">
	<div>Pending Messages : {{count}}</div>
	<input type="hidden" value="{{message._id}}" />
	<div>{{message.text}}</div>
	<button>ok</button>
	<br/><br/><br/>
</template>
<template name="joinRoom">
	<input type="text" max-length=4 /> 
	<button class="cancel">Cancel</button>
	<button class="submit">Play</button>
</template>
<template name="groupList">
	<span>Hello {{currentUser.username}} - <button onClick="Meteor.logout(function(){Meteor.call('setUserOffline');})">Logout</button></span>
	<div>Online Users: {{onlineUsers}}</div>
	<div>
		<form>
			<input type="text" id="groupName" placeholder="Group Name"/>
			<button type="submit">Create Group</button>
		</form>
	</div>
	<ul>
		{{#each groups}}
			{{> group}}
		{{/each}}
	</ul>
</template>
<template name="group">
	<li><button data-roomid="{{_id}}">Join</button> - {{name}} - {{ownerId}} - {{password}}</li>
</template>

<template name="gameRoom">
	<div> Room Code: {{group.password}}</div>
	{{#if isOwner}}
		<button id="disbandGroup" data-groupid="{{group._id}}">Disband Group</button>
	{{else}}
		You're in game room <button id="leaveGroup">Leave Group</button> {{group._id}} - {{group.name}}
	{{/if}}
	<br/>
	You are on team: {{yourTeam}} 
	<br/>
	{{#if isOwner}}
		{{> UI.dynamic template=adminControls}}
	{{/if}}
	{{> UI.dynamic template=game}}

	{{#each players}}
		{{> player}}
	{{/each}}
</template>
<template name="player">
	<li class="{{team}}">
		{{#if isRedPlayer userId lastGroup}}
			Red Team Leader
		{{/if}}
		{{#if isBluePlayer userId lastGroup}}
			Blue Team Leader
		{{/if}}
		-- {{username}} -- {{team}} {{#if online}}(Online){{else}}(Offline){{/if}}
		{{#if isOwner userId}} 
		
			<button class="kick" data-userid="{{userId}}">kick</button>
			{{#if isRedPlayer userId lastGroup}}
				<button class="blue" data-userid="{{userId}}">Groom</button>
			{{else}}
				{{#if isBluePlayer userId lastGroup}}
					<button class="red" data-userid="{{userId}}">Bride</button>
				{{else}}
				<button class="blue" data-userid="{{userId}}">Groom</button>
				<button class="red" data-userid="{{userId}}">Bride</button>
				{{/if}}
			{{/if}}
		{{/if}}
	</li>
</template>

<template name="pickTeam">
	<div>
		
		Pick Your Team: <button class="team" data-team="r">Her</button>
						<button class="team" data-team="b">Him</button>
						<button class="team" data-team="s">Spectate</button>
	</div>
</template>
<template name="startGame"> 
	<button>Start Game</button>
</template>
<template name="nextQuestion">
	{{#if everyoneHasAnswered}}
	<button id="NextQuestion">Next Question</button>
	{{else}}
	<button id="AdvanceToPicking">Go to Picking</button>
	{{/if}}
</template>
<template name="tallyScore">
	Tally score not implemented
</template>
<template name="question">
	<div>
		{{question.text}}
	</div>
	<br/>
	{{#if isTeamLeader}}
		{{#if teamLeaderHasAnswered}}
			{{#if everyoneHasAnswered}}
				{{> pickAnswer}}
			{{else}}
				<div>Your answer  {{leaderAnswer}}</div>
				<div>waiting for everyone to finish their answers</div>
			{{/if}} 
		{{else}}
			team leader anser:
			<input name="answerInput" type="text"/><button class="submitAnswer">Submit</button>
		{{/if}}
	{{else}}
		{{#if teamLeaderHasAnswered}}
			
			<br />
			{{#if userHasAnswered}}
				{{#if everyoneHasAnswered}}
					{{> pickAnswer}}
				{{else}}
					<div>waiting for everyone to finish their answers</div>
				{{/if}}
			{{else}}
				<div>your leaders answer  {{leaderAnswer}}</div>
				<input name="answerInput" type="text"/><button class="submitAnswer">Submit</button>
			{{/if}}
			
		{{else}}
			Waiting for you team leader to answer the question. 
		{{/if}}
	{{/if}}
	<br/><br/><br/>
</template>
<template name="pickAnswer">
	<div>
		{{#if isTeamLeader}}
			#####Pick the correct Answers######
		{{else}}
			#####Opposite Team Answers######
		{{/if}}
		{{#each getAnswers false}}
			{{#if isTeamLeader}}
				{{#if notAnswered}}
					{{> activeAnswer}}
				{{else}}
					{{> answer}}
				{{/if}}
			{{else}}
				{{> answer}}
			{{/if}}
		 
		{{/each}}
	</div>
	<div>
		#####Your Team Answers######
		{{#each getAnswers true}}
		
		 {{> answer}}
		{{/each}}
	</div>
</template>
<template name="answer">
	<div>
		{{chosen playerId}} - {{correct playerId}} - {{answer}}
	</div>
</template>
<template name="activeAnswer">
	<button data-playerid="{{playerId}}">{{answer}}</button>
</template>